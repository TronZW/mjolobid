{% extends 'base.html' %}

{% block title %}Create Offer - MjoloBid{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <div class="mx-auto h-16 w-16 bg-gradient-to-r from-secondary to-primary rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-gift text-white text-2xl"></i>
            </div>
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Create an Offer</h1>
            <p class="text-gray-600">Let guys know you're available for an event or specific day</p>
        </div>

        <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
            <form method="POST" class="p-8">
                {% csrf_token %}
                
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center">
                        <i class="fas fa-calendar-alt mr-2 text-primary"></i>Offer Details
                    </h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="lg:col-span-2 space-y-2">
                            <label for="{{ form.title.id_for_label }}" class="block text-sm font-semibold text-gray-700">
                                Offer Title *
                            </label>
                            {{ form.title }}
                            {% if form.title.errors %}
                                <div class="text-red-600 text-sm">{{ form.title.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Event Category (Optional)</label>
                            {{ form.event_category }}
                        </div>
                        
                        <div class="space-y-2" id="custom-category-field" style="display: none;">
                            <label class="block text-sm font-semibold text-gray-700">Custom Category</label>
                            {{ form.custom_category }}
                        </div>
                        
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Event Date & Time (Optional)</label>
                            {{ form.event_date }}
                        </div>
                        
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Available Date (Optional)</label>
                            {{ form.available_date }}
                            <p class="text-xs text-gray-500">Use this if you're generally available on a specific day</p>
                        </div>
                        
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Location</label>
                            {{ form.event_location }}
                        </div>
                        
                        <div class="space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Minimum Bid Amount *</label>
                            {{ form.minimum_bid }}
                            {% if form.minimum_bid.errors %}
                                <div class="text-red-600 text-sm">{{ form.minimum_bid.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="lg:col-span-2 space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Description *</label>
                            {{ form.description }}
                            {% if form.description.errors %}
                                <div class="text-red-600 text-sm">{{ form.description.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="lg:col-span-2 space-y-2">
                            <label class="block text-sm font-semibold text-gray-700">Address</label>
                            {{ form.event_address }}
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4">
                    <a href="{% url 'offers:my_offers' %}" class="px-6 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50">
                        Cancel
                    </a>
                    <button type="submit" class="px-6 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-semibold hover:opacity-90">
                        <i class="fas fa-check mr-2"></i>Create Offer
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const categorySelect = document.querySelector('[name="event_category"]');
    const customCategoryField = document.getElementById('custom-category-field');
    
    if (categorySelect) {
        categorySelect.addEventListener('change', function() {
            if (this.value === 'other') {
                customCategoryField.style.display = 'block';
            } else {
                customCategoryField.style.display = 'none';
            }
        });
        
        // Show on page load if "other" is selected
        if (categorySelect.value === 'other') {
            customCategoryField.style.display = 'block';
        }
    }

    // Prevent double submission of the form
    const form = document.querySelector('form');
    if (form) {
        const submitButton = form.querySelector('button[type="submit"]');
        let isSubmitting = false;

        form.addEventListener('submit', function (e) {
            if (isSubmitting) {
                e.preventDefault();
                return;
            }
            isSubmitting = true;
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.classList.add('opacity-70', 'cursor-not-allowed');
                submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Creating...';
            }
        });
    }
});
</script>
{% endblock %}

